## Download and install the Raspberry Pi Imager
https://www.raspberrypi.com/software/ 

Ubuntu: https://downloads.raspberrypi.org/imager/imager_latest_amd64.deb 

Windows: https://downloads.raspberrypi.org/imager/imager_latest.exe 

### Run the Raspberry Pi Imager
Then click "CHOOSE OS" under Operating System then "use custom" then select the `ubuntu-20.04.4-preinstalled-server-arm64+raspi.img.xz`
Then click "CHOOSE STORAGE" under Storage and then "Internal SD card reader"
Click "WRITE" enter your password if it promts you. 

Profit

After writing is compleate then mount the SD card(if not alredy) 

## Edit `/etc/netplan/50-cloud-init.yaml` 
add below to the file
```yaml
 wifis:
      wlan0:
       optional: true
       access-points:
          "dragonflyadhoc":
             password: "s:dragonfly"
       dhcp4: true
      wlan1:
       optional: true
       access-points:
          "dragonflyadhoc":
             password: "s:dragonfly"
       dhcp4: true
```
So it should ook something like this
```yaml
# This file is generated from information provided by the datasource.  Changes
# to it will not persist across an instance reboot.  To disable cloud-init's
# network configuration capabilities, write a file
# /etc/cloud/cloud.cfg.d/99-disable-network-config.cfg with the following:
# network: {config: disabled}
network:
    ethernets:
        eth0:
            dhcp4: true
            optional: true
    version: 2
    wifis:
      wlan0:
       optional: true
       access-points:
          "dragonflyadhoc":
             password: "s:dragonfly"
       dhcp4: true
      wlan1:
       optional: true
       access-points:
          "dragonflyadhoc":
             password: "s:dragonfly"
       dhcp4: true
```
Then apply it and reboot
```bash
sudo netplan apply 
sudo reboot
```
Once the system is back up verify it has network connectivity 
`ping 8.8.8.8`

### @NOTE where it is `#` please put the appropriate number
## Edit `/etc/hostname`
edit to just
`dragonfly#`

## Edit `/etc/hosts`
just below localhost paste
`127.0.1.1 dragonfly#`


if you miss the cloud init printout with the ip address you can install ifconfig
`sudo apt install net-tools`
Then run `ifconfig` and look at the inet under eth0, wlan0 and/or wlan1

# On the laptop/desktop

## Install ansible

## edit the  `/etc/ansible/hosts` file at the bottom add
```
[dragonflys]
ip_of_dragonfly1
ip_of_dragonfly2
ip_of_dragonfly3
ip_of_dragonfly4
ect
```

## Copy over your public ssh key
from the laptops `.ssh/id_rsa.pub`
insert into `.ssh/authorized_keys`

## Run the playbook from the dragonfly-controller/scripts directory
`ansible-playbook playbook.yaml -u ubuntu`

# Install Mission Planner on Windows
https://ardupilot.org/planner/docs/mission-planner-installation.html

Connect Pixhawk to computer via USB cable

Flash Arducopter firmware and restart

Copy initial parameters from another Dragonfly and restart


Verify battery voltage.  If the battery voltage is too low (11V?) then you may need to recopy in the initial parameters.

Without propellers installed, perform a motor test.  Verify correct motor orientation and spin (reference above figure)
